/*
--******************* REVISION HISTORY **************************************************************************************************
--VERSION             ACTIVITY ID  WHO    DATE      DETAILS
--Keyword_Framework_1 MSD-70553    VK     28/09/22  Initial version.
--***************************************************************************************************************************************
*/

prompt Delete existing records
Delete from s56 where macro IN ('BLANK','NAVFEES1','NAVGUIDELINE1','NAVLOAN1','NAVPROCFEES1','KFAPPGENDETS','KFCLIENTDETS','KFCOMPLETIONS','KFDDDTLS','KFFEECHRGS','KFFNDRELDETS','KFLOANDETS','KFNOTADDR','KFPROPDETS','KFSOLDETS') order by macro asc;
Delete from macro where macro IN ('BLANK','NAVFEES1','NAVGUIDELINE1','NAVLOAN1','NAVPROCFEES1','KFAPPGENDETS','KFCLIENTDETS','KFCOMPLETIONS','KFDDDTLS','KFFEECHRGS','KFFNDRELDETS','KFLOANDETS','KFNOTADDR','KFPROPDETS','KFSOLDETS') ORDER BY MACRO, ORDERBY ASC;
Delete from s47 where menuexit IN ('BLANK','NAVFEES1','NAVGUIDELINE1','NAVLOAN1','NAVPROCFEES1','KFAPPGENDETS','KFCLIENTDETS','KFCOMPLETIONS','KFDDDTLS','KFFEECHRGS','KFFNDRELDETS','KFLOANDETS','KFNOTADDR','KFPROPDETS','KFSOLDETS') order by menuexit asc;
/*Declare macro*/
prompt Importing table s56...
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('BLANK','No Script Macro - Testing',null,0,'N','Y','N','No Action Macro','A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('KFAPPGENDETS','Keyword Frameworkd Macro',null,0,'N','Y','N','Keyword Framework Macro','A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('KFCLIENTDETS','Keyword Framework Macro',null,0,'N','Y','N','Keyword Framework Macro','A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('KFCOMPLETIONS','Keyword Framework Macro',null,0,'N','Y','N','Keyword Framework Macro','A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('KFDDDTLS','Keyword Framework Macro',null,0,'N','Y','N','Keyword Framework Macro','A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('KFFEECHRGS','Keyword Framework Macro',null,0,'N','Y','N','Keyword Framework Macro','A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('KFFNDRELDETS','Keyword Framework Macro',null,0,'N','Y','N','Keyword Framework Macro','A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('KFLOANDETS','Keyword Framework Macro',null,0,'N','Y','N','Keyword Framework Macro','A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('KFNOTADDR','Keyword Framework Macro',null,0,'N','Y','N','Keyword Framework Macro','A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('KFPROPDETS','Keyword Framework Macro',null,0,'N','Y','N','Keyword Framework Macro','A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('KFSOLDETS','Keyword Frameword Macro',null,0,'N','Y','N','Keyword Framework Macro','A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('NAVFEES1','Fees',null,0,'N','Y','N',null,'A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('NAVGUIDELINE1','Guideline Checks',null,0,'N','Y','N',null,'A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('NAVLOAN1','Loan Requirements',null,0,'N','Y','N',null,'A');
Insert into S56 (MACRO,MACRO_DESC,MACRO_CAT,MACRO_SEC,MACRO_MENU,MACRO_CHECKED,MACRO_BROWSER_COMPATIBLE,MACRO_ALTERNATIVE_DESC,MACRO_APPLICATION) values ('NAVPROCFEES1','Procurement Fees',null,0,'N','Y','N',null,'A');
prompt Done.
/*Create macro*/
prompt Importing table macro...
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('BLANK','00001',null,'COMMENT',null,null,'This is a test macro to skip APPENTRYMAIN macro under Work Team Maintenance.','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00001',null,'DECLARE',null,null,'THERE','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00002',null,'WINDOW','Register Application',null,'''W_AP010_00'','''',''''','00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00003',null,'COMMENT',null,null,'Check to see if task is already present for Further Advance','00003');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00004',null,'IF',null,null,'$APPTYPE = ''F'',FADV','00004');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00005',null,'TASK','General Notes',null,'''000'',''O''','00005');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00006',null,'JUMP',null,null,'Next','00006');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00007',null,'SELECT',null,'FADV','''COUNT(*) INTO :THERE FROM OPEN_TASKS M WHERE M.MORTGAGE = :$MORTGAGE AND M.APPLSEQ = :$APPLSEQ AND M.PROGPNT = ''000''''','00007');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00008',null,'SKIPIF',null,null,'THERE > 0','00008');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00009',null,'TASK','General Notes',null,'''000'',''AO''','00009');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00010',null,'JUMP',null,null,'Next','00010');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00011',null,'WINDOW','Initial Disclsoure Details','Next','''W_AP010_01_09'','''',''''','00011');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00012',null,'COMMIT',null,null,null,'00012');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00013',null,'WINDOW','Level of Service Details',null,'''W_AP010_01_04'','''',''''','00013');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFAPPGENDETS','00014',null,'COMMIT',null,null,null,'00014');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCLIENTDETS','00001',null,'WINDOW','Applicant Details',null,'''W_AP010_03'','''',''''','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCLIENTDETS','00002',null,'WINDOW','Occupancy Details',null,'''W_AP010_06'','''',''''','00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCLIENTDETS','00003',null,'WINDOW','Applicant Bank Details Window',null,'''W_AP010_03_02_02'','''',''''','00003');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCLIENTDETS','00004',null,'WINDOW','Receipt Of Proof Of Id',null,'''W_AP010_35_05'','''',''''','00004');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCLIENTDETS','00005',null,'WINDOW','Employment Details',null,'''W_AP010_12'','''',''''','00005');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCLIENTDETS','00006',null,'WINDOW','Other Income And Expenditure','*','''W_AP010_07'','''',''''','00006');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCLIENTDETS','00007',null,'WINDOW','Client Guarantees Window','*','''W_AP010_29'','''',''''','00007');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCLIENTDETS','00008',null,'WINDOW','Credit Declarations',null,'''W_AP010_11'','''',''''','00008');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCLIENTDETS','00009',null,'COMMIT',null,null,null,'00009');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00001',null,'DECLARE','Wfl00031 Wfl00092 Wfl00093 Wfl00122 Wfl00183',null,'option,ACCVALID,ACCSTAT','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00002',null,'SERVICE','Check Whether Case Can Move To New Stage',null,'''NVUO_MACRO_NEWSTAGE'',''A'',''60''','00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00003',null,'MESSAGEBOX',null,null,'option,''Await Completion Confirmation'',''Has Completion Occurred ?'',QUESTION,YESNO','00003');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00004',null,'IF',null,null,'option = ''NO'',DELAY','00004');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00005',null,'COMMENT',null,null,'It is possible to have completed on summit but the transactions may not have been posted. This maybe because the cheque number had not be allocated (i.e. no maf20 row, interrogated within transactions. In order to get around this if the application is already completed then skip completion but still perform transaction posting.','00005');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00006',null,'COMMENT',null,null,'Recalculate reg payment and 1st payment - this may have changed as a result of completion date being revised','00006');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00007',null,'SERVICE','Calculate The Mortgage Repayment',null,'''S_REPAYMENTAPR'','''',''''','00007');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00008',null,'SERVICE','Recalculate Insurance Premium',null,'''NVUO_MACRO_RECALC_INSPREMIUMS'','''',''''','00008');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00009',null,'IF',null,null,'$APPSTATUS = ''C'',TRANS','00009');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00010',null,'SELECT','Check for returned funds after completion',null,'''ACM01.ACCSTATUS INTO :ACCSTAT FROM ACM01 WHERE ACM01.ACCNO = (SELECT MIN (ACCNO) FROM ACM01 WHERE ACM01.MORTGAGE = :$MORTGAGE AND ACM01.ACCSEQ = :$APPLSEQ)''','00010');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00011',null,'IF','If main sub-account not live then go to complete',null,'ACCSTAT # ''L'',COMP','00011');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00012',null,'SERVICE','Set Application Status To Completed',null,'''NVUO_MACRO_STATUS_COMPLETED'','''',''''','00012');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00013',null,'JUMP','Go to post transactions',null,'TRANS','00013');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00014',null,'SERVICE','Generate OMNIA Interface Files','COMP','''NVUO_MACRO_COMPLETION'','''',''''','00014');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00015',null,'SERVICE','Write Insurance Details To Momentum','*','''NVUO_MACRO_MOMENTUM'','''',''''','00015');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00016',null,'COMMIT',null,null,null,'00016');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00017',null,'SERVICE','Diary Events Service',null,'''NVUO_MACRO_DIARY_EVENTS'','''','''','''',''''','00017');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00018',null,'COMMIT',null,null,null,'00018');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00019',null,'SERVICE','Auto Account Validation',null,'''NVUO_AUTO_ACC_VALIDATION'','''','''','''',''''','00019');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00020',null,'COMMIT',null,null,null,'00020');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00021',null,'LET',null,null,'ACCVALID = ''Y''','00021');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00022',null,'SELECT','Check for Account Validation Pending Task',null,'''''N'' INTO :ACCVALID FROM OPEN_TASKS WHERE OPEN_TASKS.MORTGAGE = :$MORTGAGE AND OPEN_TASKS.STAGETYPE = ''A'' AND OPEN_TASKS.PROGPNT = ''AVP''''','00022');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00023',null,'IF','If no task validation successful so post transactions',null,'ACCVALID # ''N'',TRANS','00023');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00024',null,'RETURN',null,null,null,'00024');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00025',null,'MACRO','Post Transactions To Summit','TRANS','''TRANSACTIONS''','00025');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00026',null,'SERVICE','Added by Sally Harris. Account classification/ capital adequacy grouping service.',null,'''NVUO_MACRO_CLASS_GROUP'','''','''','''',''''','00026');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00027',null,'SERVICE','Update Deeds Movement Details',null,'''NVUO_MACRO_DEEDS_UPDATE'','''','''','''',''''','00027');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00028',null,'RETURN',null,null,null,'00028');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00029',null,'PACKAGE','Completion Confirm Package','DELAY','''COMPCONF''','00029');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFCOMPLETIONS','00030',null,'RETURN',null,null,null,'00030');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFDDDTLS','00001',null,'COMMENT','Wfl00117',null,'Navigator Direct Debit Bank Details','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFDDDTLS','00002',null,'DECLARE',null,null,'PAYMETH,@FIRSTTIME','00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFDDDTLS','00003',null,'SELECT','Check the payment method',null,'''NVL(ACM06.PMNTMETHOD,''XX'') INTO :PAYMETH FROM ACM06 WHERE ACM06.MORTGAGE = :$MORTGAGE''','00003');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFDDDTLS','00004',null,'IF','Only open direct debit if appropriate',null,'PAYMETH # ''DD'',END','00004');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFDDDTLS','00005',null,'WINDOW','Direct Debit Bank Details',null,'''W_AP010_04'','''',''''','00005');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFDDDTLS','00006',null,'COMMIT',null,null,null,'00006');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFDDDTLS','00007',null,'RETURN',null,null,null,'00007');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFDDDTLS','00008',null,'IF','No message if first time through','END','@FIRSTTIME = ''Y'',FINAL','00008');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFDDDTLS','00009',null,'MESSAGEBOX',null,null,'PAYMETH,''Direct Debit Details'',''Currently mortgage payment is not by Direct Debit'',INFORMATION,OK','00009');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFDDDTLS','00010',null,'RETURN',null,null,null,'00010');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFDDDTLS','00011',null,'LET','Reset to indicate not first time through','FINAL','@FIRSTTIME = ''N''','00011');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00008',null,'DECLARE',null,null,'LTV,MIGLTV','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00001',null,'COMMENT',null,null,'Fees including HLC Details','00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00002',null,'WINDOW','Fee Charges',null,'''W_AP012_01'','''',''''','00003');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00009',null,'SELECT',null,null,'''ACM16.ASP_LTV_CUTOFF INTO :MIGLTV FROM ACM16 WHERE ACM16.ACCCONT = ''ACCCONTROL''''','00004');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00010',null,'SELECT',null,null,'''ACT01.APPLTVINFEES INTO :LTV FROM ACT01 WHERE ACT01.MORTGAGE = :$MORTGAGE AND ACT01.APPLSEQ = :$APPLSEQ''','00005');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00011',null,'IF',null,null,'LTV > MIGLTV,HLC','00006');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00012',null,'SERVICE','Service To Delete Mig',null,'''NVUO_MACRO_DELETE_MIG'','''',''''','00007');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00013',null,'JUMP',null,null,'NEXT','00008');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00014',null,'IF',null,'HLC','$APPTYPE = ''F'',TOPUP','00009');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00015',null,'WINDOW','HLC Details',null,'''W_AP010_20'','''',''''','00010');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00016',null,'JUMP',null,null,'NEXT','00011');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00017',null,'WINDOW','Further Advance HLC Details','TOPUP','''W_AP010_28'','''',''''','00012');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00004',null,'SERVICE','Calculate Early Redemption Fees','NEXT','''NVUO_MACRO_EARLY_REDEMPTION_FEES'','''',''''','00013');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00005',null,'WINDOW','Early Redemption Fees','*','''W_AP010_02_08'','''',''''','00014');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00006',null,'SERVICE','Repayment/Apr Calculation',null,'''S_REPAYMENTAPR'','''',''''','00015');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFEECHRGS','00007',null,'COMMIT',null,null,null,'00016');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00001',null,'DECLARE',null,null,'VALUATION,OPTION,RELEASE_PAYMENT,AUTH_THRESHOLD,TIERENABLED','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00002',null,'SERVICE','Check Whether Case Can Move To New Stage',null,'''NVUO_MACRO_NEWSTAGE'',''A'',''10''','00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00003',null,'IF',null,null,'$APPTYPE = ''F'',REVAL','00003');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00004',null,'LET',null,null,'VALUATION = ''N''','00004');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00005',null,'SELECT',null,null,'''''Y'' INTO :VALUATION FROM BIT08 WHERE BIT08.MORTGAGE = :$MORTGAGE;''','00005');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00006',null,'IF',null,null,'VALUATION = ''Y'',REVAL','00006');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00007',null,'WINDOW','Valuation Report',null,'''W_AP010_39'','''',''''','00007');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00008',null,'JUMP',null,null,'NEXT','00008');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00009',null,'WINDOW','Valuation Report','REVAL','''W_AP010_39'',''ENQUIRY'',''''','00009');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00010',null,'WINDOW','Re-Valuation Report',null,'''W_AP010_38'','''',''''','00010');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00011',null,'JUMP',null,null,'NEXT','00011');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00012',null,'SERVICE','Check Whether Case Can Move To New Stage','NEXT','''NVUO_MACRO_NEWSTAGE'',''A'',''50''','00012');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00013',null,'SELECT',null,null,'''CVC.SAM05.TIER INTO :TIERENABLED FROM CVC.SAM05, CVC.ACF94 WHERE CVC.ACF94.MORTGAGE = :$MORTGAGE AND CVC.ACF94.MTG_SOC_SEQNO = CVC.SAM05.SOCSEQNO''','00013');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00014',null,'IF',null,null,'TIERENABLED # ''Y'',NEXT3','00014');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00015',null,'SERVICE','Application Tier Refresh',null,'''NVUO_MACRO_TIER_REFRESH'','''',''''','00015');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00016',null,'SERVICE','Application Tier Check',null,'''NVUO_MACRO_TIER_CHECK'','''',''''','00016');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00017',null,'IF',null,'NEXT3','$RETURNDATA = ''Y'',END','00017');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00018',null,'SERVICE','Retention Apportionment',null,'''NVUO_MACRO_RETENTION_APPORTION'','''',''''','00018');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00019',null,'WINDOW','Maintain Completion Details',null,'''W_AP034_01'','''',''''','00019');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00020',null,'SERVICE','Generate Funds Release Records',null,'''NVUO_MACRO_PRE_COMPLETE'','''',''''','00020');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00021',null,'WINDOW','Maintain Funds Release Details',null,'''W_AP038_01'','''',''''','00021');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00022',null,'SELECT',null,null,'''NVL(SAM05.FNDREL_AUTH_THRESHOLD,0) INTO :AUTH_THRESHOLD FROM CVC.SAM05, CVC.ACF94 WHERE SAM05.SOCSEQNO = ACF94.MTG_SOC_SEQNO AND ACF94.MORTGAGE = :$MORTGAGE''','00022');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00023',null,'SELECT',null,null,'''ACT18.RELPAYAMT INTO :RELEASE_PAYMENT FROM ACT18 WHERE ACT18.MORTGAGE = :$MORTGAGE AND ACT18.APPLSEQ = :$APPLSEQ''','00023');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00024',null,'IF',null,null,'AUTH_THRESHOLD = 0,SIGNOFF','00024');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00025',null,'IF',null,null,'RELEASE_PAYMENT > AUTH_THRESHOLD,CONT','00025');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00026',null,'SERVICE','Funds Release Final Manager Signoff','SIGNOFF','''NVUO_MACRO_MANAGER_SIGNOFF'','''',''''','00026');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00027',null,'SERVICE','Repayment/Apr Calculation',null,'''S_REPAYMENTAPR'','''',''''','00027');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00028',null,'MESSAGEBOX',null,null,'OPTION,''Fund Release'',''Funds Will Automatically be Released'',INFORMATION,OK','00028');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00029',null,'JUMP',null,'END','NEXT2','00029');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00030',null,'MESSAGEBOX',null,'CONT','OPTION,''Funds Release'',''Funds Will Automatically be Released'',INFORMATION,OK','00030');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00031',null,'WINDOW','Batch Generation Confirmation','NEXT2','''W_MA147_04'',''TT'',''''','00031');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00032',null,'WINDOW','Generate Chaps File Funder Selection',null,'''W_AP264_01'','''',''''','00032');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00033',null,'SERVICE','Release CHAPS Funds (Batch)',null,'''NVUO_MACRO_FUNDS_CHAPS'','''',''''','00033');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00034',null,'SERVICE','Produce CHAPS ASCII File',null,'''NVUO_MACRO_CHAPS_BATCH'','''',''''','00034');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFFNDRELDETS','00035',null,'COMMIT',null,null,null,'00035');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFLOANDETS','00001',null,'MACRO','Loan Requirements',null,'''NAVLOAN1''','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFLOANDETS','00002',null,'MACRO','Assessable Income',null,'''NAVASSESSINC''','00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFLOANDETS','00003',null,'MACRO','Client Affordability',null,'''NAVAFFORD''','00003');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFLOANDETS','00004',null,'MACRO','Guideline Checks',null,'''NAVGUIDELINE1''','00004');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFLOANDETS','00005',null,'COMMIT',null,null,null,'00005');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFNOTADDR','00001',null,'WINDOW','Notice Address',null,'''W_MA003_01'','''',''''','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFNOTADDR','00002',null,'COMMIT',null,null,null,'00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFPROPDETS','00001',null,'WINDOW','Property Details',null,'''W_AP010_08'','''',''''','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFPROPDETS','00002',null,'COMMIT',null,null,null,'00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFSOLDETS','00001',null,'MACRO','Solicitor / Solicitor Bank Details',null,'''NAVSOLDETS''','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('KFSOLDETS','00002',null,'COMMIT',null,null,null,'00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVFEES1','00001',null,'COMMENT','Wfl00117, Wfl00137 Wfl00240',null,'Fees including HLC Details','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVFEES1','00002',null,'WINDOW','Fee Charges',null,'''W_AP012_01'','''',''''','00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVFEES1','00003',null,'MACRO','HLC Details',null,'''HLCDETS''','00003');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVFEES1','00004',null,'SERVICE','Calculate Early Redemption Fees',null,'''NVUO_MACRO_EARLY_REDEMPTION_FEES'','''',''''','00004');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVFEES1','00005',null,'WINDOW','Early Redemption Fees','*','''W_AP010_02_08'','''',''''','00005');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVFEES1','00006',null,'SERVICE','Repayment/Apr Calculation',null,'''S_REPAYMENTAPR'','''',''''','00006');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVFEES1','00007',null,'COMMIT',null,null,null,'00007');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVGUIDELINE1','00001',null,'COMMENT','Wfl00169',null,'Perform Guideline Checks and show results','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVGUIDELINE1','00002',null,'SERVICE','Guideline Checks Service',null,'''S_GUIDELINE_CHECKS'','''',''''','00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVGUIDELINE1','00003',null,'WINDOW','Guideline Checks Results','*','''W_AP037_01_06'','''',''''','00003');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVGUIDELINE1','00004',null,'COMMIT',null,null,null,'00004');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00001',null,'COMMENT','Wfl00117, wfl00240, wfl00259, wfl00262',null,'Navigator Loan Requirements - Primary Advance','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00002',null,'DECLARE',null,null,'CAPRAISE,LTV','00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00003',null,'WINDOW','Loan Requirements',null,'''W_AP010_02'','''',''''','00003');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00004',null,'COMMIT',null,null,null,'00004');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00005',null,'COMMENT',null,null,'If capital raising and LTV > 75% then open task','00005');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00006',null,'LET',null,null,'CAPRAISE = ''N''','00006');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00007',null,'SELECT',null,null,'''''Y'' INTO :CAPRAISE FROM ACM01, MAM03 WHERE ACM01.MORTGAGE = :$MORTGAGE AND ACM01.ACCSEQ = :$APPLSEQ AND MAM03.PURPOSECODE = ACM01.PURPOSECODE AND MAM03.CAPITALRAISING = ''Y''''','00007');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00008',null,'IF',null,null,'CAPRAISE # ''Y'',NOCAPERR','00008');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00009',null,'SELECT',null,null,'''ACT01.APPLTVEXFEES INTO :LTV FROM ACT01 WHERE ACT01.MORTGAGE = :$MORTGAGE AND ACT01.APPLSEQ = :$APPLSEQ''','00009');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00010',null,'IF',null,null,'LTV <= 75,NOCAPERR','00010');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00011',null,'TASK','Capital Raising - Ltv > 75%',null,'''CAP'',''O''','00011');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00012',null,'COMMIT',null,null,null,'00012');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00013',null,'COMMENT',null,'NOCAPERR','Do Calculations','00013');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00014',null,'SERVICE','Repayment/Apr Calculation',null,'''S_REPAYMENTAPR'','''',''''','00014');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00015',null,'SERVICE','Calculate Application Mandate Level',null,'''NVUO_MACRO_CALCULATE_MANDATE'','''',''''','00015');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00016',null,'SERVICE','Recalculate Insurance Premium',null,'''NVUO_MACRO_RECALC_INSPREMIUMS'','''',''''','00016');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00017',null,'SERVICE','Calculate The Cashback Amount',null,'''NVUO_MACRO_CASHBACK'','''',''''','00017');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00018',null,'MACRO','Generate Lifetime Amortisation Figures',null,'''AMORTISATION''','00018');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00019',null,'MACRO','Procurement Fees',null,'''NAVPROCFEES1''','00019');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVLOAN1','00020',null,'COMMIT',null,null,null,'00020');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVPROCFEES1','00001',null,'COMMENT','Wfl00262',null,'Calculate and display proc fees if there is an introducer','00001');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVPROCFEES1','00002',null,'DECLARE',null,null,'INTROCOUNT','00002');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVPROCFEES1','00003',null,'SELECT',null,null,'''COUNT(*) INTO :INTROCOUNT FROM ACT01 WHERE APPSOURCEC1 IS NULL AND APPSOURCEC2 IS NULL AND MORTGAGE = :$MORTGAGE.''','00003');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVPROCFEES1','00004',null,'SKIPIF',null,null,'INTROCOUNT = 0','00004');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVPROCFEES1','00005',null,'RETURN','Exit if no introducers',null,null,'00005');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVPROCFEES1','00006',null,'SERVICE','Proc Fee Calc ',null,'''NVUO_MACRO_PROCFEES'','''',''''','00006');
Insert into MACRO (MACRO,LINE,INSTRUCTION,COMMAND,COMMENTS,LABEL,ARGUMENTS,ORDERBY) values ('NAVPROCFEES1','00007',null,'WINDOW','Procurement Fee','*','''W_AP010_01_06'','''',''''','00007');
prompt Done.
/*Add macro as valid option*/
prompt Importing table s47...
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('BLANK','8','N','No Script Macro - Testing',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('KFAPPGENDETS','8','N','Keyword Frameworkd Macro',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('KFCLIENTDETS','8','N','Keyword Framework Macro',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('KFCOMPLETIONS','8','N','Keyword Framework Macro',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('KFDDDTLS','8','N','Keyword Framework Macro',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('KFFEECHRGS','8','N','Keyword Framework Macro',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('KFFNDRELDETS','8','N','Keyword Framework Macro',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('KFLOANDETS','8','N','Keyword Framework Macro',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('KFNOTADDR','8','N','Keyword Framework Macro',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('KFPROPDETS','8','N','Keyword Framework Macro',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('KFSOLDETS','8','N','Keyword Frameword Macro',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('NAVFEES1','8','N','Fees',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('NAVGUIDELINE1','8','N','Guideline Checks',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('NAVLOAN1','8','N','Loan Requirements',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
Insert into S47 (MENUEXIT,EXITTYPE,OKONMENU,EXITDESC,BITMAPLABEL,SOFTLOCK,NAVIGATE,NAVICON,NAVTEXT,OKINMACRO,LICAREFERENCE,ALLOWENQUIRY,EXIT_APPLICATION,VOM_ALLOW_SCREEN_CONFIG,VOM_SCREEN_CONFIG_XML_VALUE) values ('NAVPROCFEES1','8','N','Procurement Fees',null,'N','N',null,null,'Y',null,'N','A','N', EMPTY_CLOB());
prompt Done.
/*Update entries for Work team to use 'BLANK' macro for society 1 and team 'HOF'*/
Update BIM03 Set WTPAMACRO = 'BLANK', WTFAMACRO = 'BLANK' Where WORKGROUP = '1' AND WORKTEAM = 'HOF';
--Update BIM03 Set WTPAMACRO = 'APPENTRYMAIN', WTFAMACRO = 'NAVVTOMFULL' Where WORKGROUP = '1' AND WORKTEAM = 'HOF';
